<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>FocusPoint — Polygon Demo</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://api.fontshare.com/v2/css?f[]=chubbo@200,300,400,500,600,700,800,900&display=swap" rel="stylesheet" />
    <link href="https://api.fontshare.com/v2/css?f[]=supreme@200,300,400,500,600,700,800,900&display=swap" rel="stylesheet" />
  </head>

  <body>
    <div id="app">
      <header id="header">
        <div class="header-left">
          <h1 class="title">FocusPoint</h1>
          <div class="subtitle">Draw a polygon, track it, export frame coords</div>
        </div>
        <div class="header-controls">
          <button id="modeToggle" class="pill">Mode: View</button>
          <button id="loopToggle" class="pill">Loop: On</button>
        </div>
      </header>

      <div id="layout">
        <aside id="sidebar" class="card">
          <div class="sidebar-top">
            <h2>Controls</h2>
            <button id="collapseBtn" class="icon-btn" title="Hide panel">⟨</button>
          </div>

          <div class="control-row">
            <label>Upload video</label>
            <input id="fileInput" type="file" accept="video/*" />
          </div>

          <div class="divider"></div>

          <!-- NEW: gate annotation -->
          <div class="control-row">
            <button id="startAnnotBtn" class="primary">Start Annotation</button>
            <div class="hint">
              Click 3 points to create a closed polygon. Drag points to adjust.
            </div>
          </div>

          <div class="control-row buttons">
            <button id="undoBtn">Undo</button>
            <button id="clearBtn">Clear</button>
          </div>

          <div class="control-row buttons">
            <button id="startTrackBtn" class="primary">Start Demo Tracking</button>
            <button id="saveBtn" class="primary">Save Polygon</button>
          </div>

          <div class="summary-block">
            <h3>Session Summary</h3>
            <div id="summaryText">No summary yet.</div>
          </div>
        </aside>

        <main id="main" class="card">
          <div id="videoContainer">
            <video id="video" controls crossorigin="anonymous"></video>
            <canvas id="overlay"></canvas>

            <!-- NEW: shown when sidebar is hidden -->
            <button id="sidebarOpenBtn" class="sidebar-open" title="Show panel">☰</button>
          </div>

          <div id="info">
            Load a video → click “Start Annotation” → place 3 points → adjust → start tracking.
          </div>
        </main>
      </div>
    </div>

    <script>window.API_BASE = "http://127.0.0.1:8000"</script>
    <script src="app.js"></script>
  </body>
</html>
